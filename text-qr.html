<!DOCTYPE html>
<html lang="hy">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Տեքստից QR Կոդ</title>
<style>
  body { font-family: "Segoe UI", sans-serif; background: #f0f4f8; margin: 0; padding: 20px; text-align: center; }
  h1 { color: #2c3e50; font-size: 32px; margin-bottom: 20px; }
  textarea { width: 90%; max-width: 700px; height: 200px; padding: 12px; border-radius: 10px; border: 1px solid #ccc; font-size: 16px; resize: vertical; margin-bottom: 20px; }
  button { background: #6c5ce7; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 16px; cursor: pointer; margin: 5px; font-weight: bold; }
  button:hover { background: #4b36c5; }
  .qr-container { margin-top: 20px; }
  .qr-container img { margin-bottom: 15px; }
  .text-page { padding: 20px; background: white; max-width: 800px; margin: 20px auto; border-radius: 10px; text-align: left; white-space: pre-wrap; font-size: 16px; }
  .download-buttons button { margin: 5px; }
</style>
</head>
<body>

<h1>Տեքստից QR Կոդ</h1>

<textarea id="text" placeholder="Մուտքագրեք ցանկացած տեքստ..."></textarea><br>
<button onclick="generateQRCode()">Ստեղծել QR</button>

<div id="qr-text" class="qr-container"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
<script>
function generateQRCode() {
  const value = document.getElementById("text").value.trim();
  if (!value) { alert("Խնդրում ենք մուտքագրել տեքստ։"); return; }

  // Ստեղծել նոր HTML էջ Data URL
  const htmlContent = `
    <!DOCTYPE html>
    <html lang="hy">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Ամփոփիչ աշխատանք</title>
      <style>
        body { font-family: "Segoe UI", sans-serif; background:#f0f4f8; padding:20px; }
        .text-page { padding:20px; background:white; max-width:800px; margin:20px auto; border-radius:10px; white-space:pre-wrap; font-size:16px; }
        button { background:#6c5ce7; color:white; border:none; padding:10px 20px; border-radius:8px; font-size:16px; cursor:pointer; margin:5px; }
        button:hover { background:#4b36c5; }
      </style>
    </head>
    <body>
      <div class="text-page">${value}</div>
      <button onclick="downloadPNG()">Ներբեռնել որպես PNG</button>
      <button onclick="downloadPDF()">Ներբեռնել որպես PDF</button>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
      <script>
        function downloadPNG() {
          const el = document.querySelector('.text-page');
          html2canvas(el).then(canvas => {
            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png');
            link.download = 'text_as_image.png';
            link.click();
          });
        }
        function downloadPDF() {
          const el = document.querySelector('.text-page');
          html2canvas(el).then(canvas => {
            const imgData = canvas.toDataURL('image/png');
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p','pt','a4');
            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            const ratio = Math.min(pageWidth/canvas.width, pageHeight/canvas.height);
            pdf.addImage(imgData,'PNG',0,0,canvas.width*ratio,canvas.height*ratio);
            pdf.save('text_as_pdf.pdf');
          });
        }
      </script>
    </body>
    </html>
  `;

  const dataUrl = 'data:text/html;base64,' + btoa(unescape(encodeURIComponent(htmlContent)));

  // Ստեղծել QR կոդը միայն Data URL-ի համար
  const container = document.getElementById("qr-text");
  container.innerHTML = "";
  const qr = new QRious({ value: dataUrl, size: 300 });
  const img = qr.image;
  container.appendChild(img);

  const openBtn = document.createElement("button");
  openBtn.textContent = "Բացել աշխատանքը նոր էջում";
  openBtn.onclick = () => { window.open(dataUrl, "_blank"); };
  container.appendChild(openBtn);
}
</script>

</body>
</html>
